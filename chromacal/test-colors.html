<!DOCTYPE html>
<html>
<head>
    <title>ChromaCal Color Test</title>
    <style>
        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
        }
        .test-case {
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            transition: background-color 1s ease-in-out;
        }
        .time {
            font-size: 24px;
            font-weight: bold;
        }
        .description {
            margin-top: 10px;
            color: #4A4A4A;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            background: #0066CC;
            color: white;
            cursor: pointer;
        }
        button:hover {
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ChromaCal Color Test</h1>
        <div>
            <button onclick="runAllTests()">Run All Tests</button>
            <button onclick="resetTests()">Reset</button>
        </div>
        <div id="testCases"></div>
    </div>

    <script type="module">
        import { colorManager } from './src/services/color-manager.ts';

        window.testCases = [
            {
                name: "No Events",
                time: "14:00",
                events: [],
                description: "Should show neutral gray"
            },
            {
                name: "Event in 2 hours",
                time: "14:00",
                events: [{
                    id: "1",
                    summary: "Test Event",
                    start: "2025-01-14T16:00:00",
                    end: "2025-01-14T17:00:00"
                }],
                description: "Should show neutral gray"
            },
            {
                name: "Event in 45 minutes",
                time: "14:15",
                events: [{
                    id: "2",
                    summary: "Test Event",
                    start: "2025-01-14T15:00:00",
                    end: "2025-01-14T16:00:00"
                }],
                description: "Should show light blue transition"
            },
            {
                name: "Event in 20 minutes",
                time: "14:40",
                events: [{
                    id: "3",
                    summary: "Test Event",
                    start: "2025-01-14T15:00:00",
                    end: "2025-01-14T16:00:00"
                }],
                description: "Should show medium blue transition"
            },
            {
                name: "Event in 5 minutes",
                time: "14:55",
                events: [{
                    id: "4",
                    summary: "Test Event",
                    start: "2025-01-14T15:00:00",
                    end: "2025-01-14T16:00:00"
                }],
                description: "Should show deep blue transition"
            },
            {
                name: "Current Event",
                time: "15:30",
                events: [{
                    id: "5",
                    summary: "Test Event",
                    start: "2025-01-14T15:00:00",
                    end: "2025-01-14T16:00:00"
                }],
                description: "Should show imminent blue"
            },
            {
                name: "After Hours",
                time: "18:30",
                events: [],
                description: "Should show soft purple"
            }
        ];

        function createTestCase(test) {
            const div = document.createElement('div');
            div.className = 'test-case';
            div.innerHTML = `
                <div class="time">${test.name} (${test.time})</div>
                <div class="description">${test.description}</div>
            `;
            return div;
        }

        function setupTests() {
            const container = document.getElementById('testCases');
            container.innerHTML = '';
            window.testCases.forEach(test => {
                container.appendChild(createTestCase(test));
            });
        }

        window.runAllTests = async () => {
            const testCases = document.querySelectorAll('.test-case');
            for (let i = 0; i < window.testCases.length; i++) {
                const test = window.testCases[i];
                const testCase = testCases[i];
                const [hours, minutes] = test.time.split(':');
                const testDate = new Date(2025, 0, 14);
                testDate.setHours(parseInt(hours), parseInt(minutes), 0);
                
                colorManager.enableTestMode({ currentTime: testDate });
                const color = colorManager.getBackgroundColor(test.events);
                testCase.style.backgroundColor = color;
                
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
        };

        window.resetTests = () => {
            colorManager.disableTestMode();
            const testCases = document.querySelectorAll('.test-case');
            testCases.forEach(testCase => {
                testCase.style.backgroundColor = '#f5f5f5';
            });
        };

        setupTests();
    </script>
</body>
</html>